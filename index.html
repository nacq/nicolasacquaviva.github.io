<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nico@home</title>
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu+Mono&display=swap" rel="stylesheet">
    <style>
        html {
            background-color: #000;
            color: #fff;
            font-family: 'Ubuntu Mono', monospace;
            height: 100%;
            pointer-events: none;
        }

        body {
            height: 100%;
        }

        .container {
            height: 100%;
            width: 100%;
        }

        @media (min-width: 700px) {
            .container {
                align-items: center;
                display: flex;
                justify-content: center;
            }

            .terminal {
                max-width: 700px;
                width: 700px;
            }
        }

        .history p {
            margin: 0;
            white-space: pre-line;
        }

        .terminal textarea, .history {
            color: #fff;
            font-size: 18px;
        }

        .terminal textarea {
            background-color: #000;
            border: none;
            font-family: 'Ubuntu Mono', monospace;
            outline: none;
            padding: 0;
            resize: none;
            width: 100%;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="terminal">
            <div class="history"></div>
            <textarea autofocus spellcheck="false" type="text"></textarea>
        </div>
    </div>
    <script type="text/javascript">
        (function() {
            const historyNode = document.getElementsByClassName('history')[0];
            const ps1 = "nico@home:~$ ";
            const textArea = document.querySelector('textarea');

            const commands = {
                clear: clearConsole,
                ls: listDirectory,
                'ls -a': listDirectoryWithHidden,
                'cat contact.txt': showContactInformation
            };

            textArea.value = ps1;
            textArea.focus();
            textArea.onblur = onBlur;
            textArea.onkeydown = onKeyDown;

            function clearConsole () {
                while (historyNode.firstChild) {
                    historyNode.removeChild(historyNode.firstChild);
                }
            }

            function listDirectory () {
                const contactNode = document.createElement('p');

                contactNode.innerHTML = 'contact.txt';
                historyNode.appendChild(contactNode);
            }

            function listDirectoryWithHidden () {
                const listNode = document.createElement('p');

                listNode.innerHTML = '.&nbsp;&nbsp;&nbsp;..&nbsp;&nbsp;&nbsp;contact.txt';

                historyNode.appendChild(listNode);
            }

            function showContactInformation () {
                const contactNode = document.createElement('p');

                contactNode.innerHTML = `email: nicolaseacquaviva@gmail.com
                github: github.com/nicolasacquaviva
                linkedin: linkedin.com/in/nicolasacquaviva`;

                historyNode.appendChild(contactNode);
            }

            function handleCommandNotFound (command) {
                const commandNotFoundNode = document.createElement('p');

                commandNotFoundNode.innerHTML = `command not found: ${command}`;

                historyNode.appendChild(commandNotFoundNode);
            }

            function resetInput () {
                textArea.value = ps1;
                textArea.focus();
            }

            function onBlur (event) {
                textArea.focus();
            }

            function executeCommand (command) {
                const commandText = command.substr(ps1.length, command.length);
                const executedCommandNode = document.createElement('p');

                executedCommandNode.innerHTML = command;
                historyNode.appendChild(executedCommandNode);

                try {
                    commands[commandText]();
                } catch (error) {
                    handleCommandNotFound(commandText);
                }

                resetInput();
            }

            function onKeyDown (event) {
                if (textArea.value === ps1 && event.key === 'Backspace') {
                    event.preventDefault();
                }

                if (~event.key.indexOf('Arrow')) {
                    event.preventDefault();
                }

                if (event.key === 'Enter') {
                    event.preventDefault();

                    if (textArea.value !== ps1) {
                        executeCommand(textArea.value);
                    } else {
                        const emptyNode = document.createElement('p');

                        emptyNode.innerHTML = ps1;

                        historyNode.appendChild(emptyNode);
                    }
                }
            };
        })()
    </script>
</body>
</html>
